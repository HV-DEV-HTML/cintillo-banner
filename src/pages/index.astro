---
import Layout from '@layouts/Layout.astro';
---

<Layout title='Cintillo Banner - Contador'>
	<div class="w-full relative py-7 overflow-hidden" id="banner_cintillo"
		data-date-init="Oct 10, 2025, 12:15:00 AM Central Daylight Time"
		data-date-end="Oct 24, 2025, 11:37:00 AM Central Daylight Time"
		style="display: none;"
		>
		<picture class="w-full h-full object-cover absolute top-0 left-0 z-0 bg_banner">
			<img src="https://pe-backoffice-portal.prod.clarodigital.net/portal/pe/recursos_contenido/1752270964778-bg_cyber_desktop.jpg" alt="background" class="">
		</picture>
		<div class="w-full max-w-[1240px] pr-2 mx-auto flex justify-center sm:w-[96%] relative">
			<!-- <a class="absolute top-0 left-0 z-1 w-full h-full opacity-0 cursor-pointer" 
				 href="https://www.tiendaclaro.pe/?utm_campaign=cyber_claro&utm_source=medios_propios&utm_medium=claro_pe&utm_content=cintillo_home-cyberclaro_tiendaclaro&utm_term=postpago-portabilidad+renovacion&cu=cp1751883915" 
				 target="_blank"></a> -->
			<div class="w-full max-w-[1000px] flex gap-4 md:gap-10 justify-center items-center relative z-10">
				<!-- Header con logo -->
				<div class=" grow-0 hidden md:flex logo_banner">
					<picture class="block h-auto self-center max-w-[74px] md:max-w-[140px]">
						<img
							src="https://test-claro-pe.prod.clarodigital.net/portal/pe/recursos_contenido/135a9f3f-b876-4a00-9651-61e4a9822f6b-peru_ecuador.png" 
							alt="CYBER WOW" 
						width="128" 
						height="35"
						>
					</picture>
				</div>
				
				<!-- Sección del Cintillo contador -->
				<div class="flex justify-center md:mx-auto items-center flex-col md:flex-row countdown_section">
					<div class="pr-5 md:pr-[15px] max-sm:pr-0 max-sm:mx-auto max-sm:mb-[4.5px] max-sm:pl-2.5">
						<h3 class="font-amx-regular text-sm md:text-lg leading-none">
							Empieza en:
						</h3>
					</div>
					
					<div class="flex flex-wrap h-fit pt-1 md:pt-0" id="countdown">
						<!-- Days -->
						<dl class="flex flex-wrap h-fit">
							<dt data-top="DÍA" class="flex flex-wrap relative h-fit after:content-[attr(data-top)] after:font-amx-regular after:text-[6px] after:block after:pt-2.5 after:pl-0.5 after:-mr-1.5  max-sm:after:pt-0 max-sm:after:mt-0 max-sm:after:text-[5px] max-sm:after:-mr-3">
								<h4 class="font-amx-black text-[24px] leading-normal h-fit md:text-[36px] max-sm:leading-[25px]">
									<span class="dia_digito1"></span><span class="dia_digito2"></span>
								</h4>
							</dt>
							<dd class="mx-[5px] h-fit max-sm:mx-1.5">
								<h4 class="font-amx-black text-[25px] text-white leading-[47px] md:text-lg max-sm:text-lg max-sm:leading-[25px]">:</h4>
							</dd>
						</dl>
						
						<!-- Hours -->
						<dl class="flex flex-wrap h-fit">
							<dt data-top="HORAS" class="flex flex-wrap relative h-fit after:content-[attr(data-top)] after:font-amx-regular after:text-[6px] after:block after:pt-2.5 after:pl-0.5 after:-mr-1.5  max-sm:after:pt-0 max-sm:after:mt-0 max-sm:after:text-[5px] max-sm:after:-mr-3">
								<h4 class="font-amx-black text-[24px] leading-normal h-fit md:text-[36px] max-sm:leading-[25px]">
									<span class="hora_digito1"></span><span class="hora_digito2"></span>
								</h4>
							</dt>
							<dd class="mx-[5px] h-fit max-sm:mx-1.5">
								<h4 class="font-amx-black text-[25px] text-white leading-[47px] md:text-lg max-sm:text-lg max-sm:leading-[25px]">:</h4>
							</dd>
						</dl>
						
						<!-- Minutes -->
						<dl class="flex flex-wrap h-fit">
							<dt data-top="MIN" class="flex flex-wrap relative h-fit after:content-[attr(data-top)] after:font-amx-regular after:text-[6px] after:block after:pt-2.5 after:pl-0.5 after:-mr-1.5  max-sm:after:pt-0 max-sm:after:mt-0 max-sm:after:text-[5px] max-sm:after:-mr-3">
								<h4 class="font-amx-black text-[24px] leading-normal h-fit md:text-[36px] max-sm:leading-[25px]">
									<span class="minuto_digito1"></span><span class="minuto_digito2"></span>
								</h4>
							</dt>
							<dd class="mx-[5px] h-fit max-sm:mx-1.5">
								<h4 class="font-amx-black text-[25px] text-white leading-[47px] md:text-lg max-sm:text-lg max-sm:leading-[25px]">:</h4>
							</dd>
						</dl>
						
						<!-- Seconds -->
						<dl class="flex-wrap h-fit hidden md:flex">
							<dt data-top="SEG" class="flex flex-wrap relative h-fit after:content-[attr(data-top)] after:font-amx-regular after:text-[6px] after:block after:pt-2.5 after:pl-0.5 after:-mr-1.5  max-sm:after:pt-0 max-sm:after:mt-0 max-sm:after:text-[5px] max-sm:after:-mr-3">
								<h4 class="font-amx-black text-[24px] leading-normal h-fit md:text-[36px] max-sm:leading-[25px]">
									<span class="segundo_digito1"></span><span class="segundo_digito2"></span>
								</h4>
							</dt>
						</dl>
					</div>
				</div>
				<!-- Fin Cintillo contador -->

				<!-- Contenido de Cintillo Cyber -->
				<div class="flex justify-center max-w-[224px] md:max-w-fit md:mx-auto items-center flex-col md:flex-row cyber_section">
					<p class="text-sm md:text-lg xl:text-xl font-roboto font-medium">Descuentos en equipos, promos y más del 14 al 17 de Julio.</p>
				</div>
				<!-- Fin Contenido de Cintillo Cyber -->
				
				<!-- Botón de ver más -->
				<div class="grow-0 flex lg:pl-[1%] md:pr-[5%]">
					<a href="#" 
						 target="_blank"
						 class="font-roboto font-bold text-[12px] py-3 px-4 rounded-[20px] self-center view_more_btn">
						<span class="table-cell">Ver más</span>
					</a>
				</div>
				
				<!-- Botón de cierre -->
				<button class="absolute -top-6 md:top-0 right-1 h-full flex justify-center items-center z-2 cursor-pointer lg:-right-[4%] md:right-0 closeElement">
					<svg class="size-4 lg:size-5" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path d="M17 1L1 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
						<path d="M1 1L17 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
					</svg>
				</button>
			</div>
		</div>
	</div>
</Layout>


<style is:inline>
	#banner_cintillo{
		--countdown-bg-color: coral;
		--countdown-text-color: #DA291C;
		--countdown-btn-bg-color: coral;
		--countdown-btn-text-color: #FFFFFF;
		--countdown-close-color: #5f5e5e;
		--countdown-btn-bg-color-hover: color-mix(in srgb, var(--countdown-btn-bg-color), black 30%);
		background-color: var(--countdown-bg-color);
	}
	.toolbar-opened .stControlBody #banner_cintillo{
		display: block !important;
	}
	.headerEv+.wrapper {
		padding-top: 88px;
	}

	@media (min-width: 1024px) {
		.headerEv+.wrapper {
			padding-top: 96px;
		}
	}
	#banner_cintillo .inlineEditToolbar{
		max-width: 200px !important;
	}
	#banner_cintillo .countdown_section{
		& h3{
			color: var(--countdown-text-color);
		}
		& h4{
			color: var(--countdown-text-color);
		}
		& dt::after{
			color: var(--countdown-text-color);
		}
	}
	#banner_cintillo .bg_banner img{
		width: 100%;
		height: 100%;
		object-fit: cover;
		@media (min-width: 1024px) {
			object-fit: fill;
		}
	}
	#banner_cintillo .cyber_section{
		& p{
			color: var(--countdown-text-color);
		}
	}
	#banner_cintillo .view_more_btn{
		background-color: var(--countdown-btn-bg-color);
		color: var(--countdown-btn-text-color);
		transition: all 0.3s ease-in-out;
		&:hover{
			background-color: var(--countdown-btn-bg-color-hover);
		}
	}
	#banner_cintillo .closeElement{
		color: var(--countdown-close-color);
	}
	#banner_cintillo.sticky {
		position: fixed;
		top: 55px;
		right: 0;
		left: 0;
		z-index: 10;
	}

	@media screen and (max-width: 820px) {
		#banner_cintillo.sticky {
			top: 50px;
		}
	}

	@media screen and (max-width: 660px) {
		#countdown {
			padding-top: 0px;
			height: 30px;
		}

		#banner_cintillo {
			padding: 10px 0;
		}
	}

	@media screen and (max-width: 540px) {
		#banner_cintillo {
			padding: 8px 0;
		}
	}
	.headerEv .hdMainLeft .logo img{
		max-width: fit-content;
	}
</style>

<script is:inline>
	window.IS_DEVELOP = true;
	window.CONTADOR_ACTIVO = true;
	window.SHOWCYBERTOFINISHED = true;
</script>
<script>
  import { parseFechaCMS, startCountdown } from '@/utils/countdown.js';
	const CONTADOR_ACTIVO = typeof (window as any).CONTADOR_ACTIVO !== 'undefined' && (window as any).CONTADOR_ACTIVO;
	const SHOWCYBERTOFINISHED = typeof (window as any).SHOWCYBERTOFINISHED !== 'undefined' && (window as any).SHOWCYBERTOFINISHED;
  // Configuration
  const limitDesktop = 100;
  const limitMobile = 70;

  // Obtener elementos
  const banner_cintillo = document.querySelector(`#banner_cintillo`) as HTMLElement;
	const logo_banner = banner_cintillo.querySelector(`.logo_banner`) as HTMLElement;
  const banner_contador = banner_cintillo.querySelector(`.countdown_section`) as HTMLElement;
  const banner_cyber = banner_cintillo.querySelector(`.cyber_section`) as HTMLElement;
  const closeElement = banner_cintillo.querySelector(`.closeElement`) as HTMLElement;
  if (CONTADOR_ACTIVO) {
		banner_contador?.classList.remove('hidden');
		banner_cyber?.classList.add('hidden');
		logo_banner?.classList.remove('hidden');
		logo_banner?.classList.add('flex');
	} else {
		banner_cintillo.classList.add('cyber');
		banner_contador?.classList.add('hidden');
		banner_cyber?.classList.remove('hidden');
		logo_banner?.classList.add('hidden');
		logo_banner?.classList.remove('flex');
	}
	
  if (!banner_cintillo) {
    console.error(`Banner cintillo no encontrado`);
  } else {
    // Obtener fechas a partir de atributos de datos
    const counterDateInit = banner_cintillo.getAttribute('data-date-init');
    const counterDateEnd = banner_cintillo.getAttribute('data-date-end');
    
    const now = new Date();
    const dateInit = parseFechaCMS(counterDateInit);
    console.log({dateInit});
    console.log(dateInit.toLocaleString());
    
    const dateEnd = parseFechaCMS(counterDateEnd);
    console.log({dateEnd});
    console.log(dateEnd.toLocaleString());
    
    let targetDate;
    let shouldShow = false;

    // Verificar si IS_DEVELOP está definido globalmente
    const isDevelopMode = typeof (window as any).IS_DEVELOP !== 'undefined' && (window as any).IS_DEVELOP;
		console.log( { isDevelopMode} )
    // Lógica de negocio: determinar si el banner debe mostrarse y qué fecha contar
    if (now < dateInit) {
      // Antes de iniciar
      targetDate = dateInit;
      shouldShow = isDevelopMode;
    } else if (now >= dateInit && now < dateEnd) {
      // En curso
      targetDate = dateEnd;
      shouldShow = true;
    } else {
      // Terminó - usar dateEnd para mostrar el contador en 00:00:00
      targetDate = dateEnd;
      shouldShow = isDevelopMode;
    }

    // Mostrar/ocultar banner y iniciar conteo
    if (shouldShow && targetDate) {
      banner_cintillo.removeAttribute('style');
			if (banner_contador) {
				startCountdown(targetDate, () => {
					// Callback que se ejecuta cuando el contador llega a 0
					if (SHOWCYBERTOFINISHED) {
						banner_cintillo.classList.add('cyber');
						banner_contador?.classList.add('hidden');
						banner_cyber?.classList.remove('hidden');
						logo_banner?.classList.add('hidden');
						logo_banner?.classList.remove('flex');
					}
				});
			}
    } else {
      banner_cintillo.style.display = 'none';
    }
		const limit = window.matchMedia("(max-width: 541px)").matches ? limitMobile : limitDesktop;
		// Comportamiento sticky al desplazarse
		window.addEventListener('scroll', function() {
			if (window.scrollY > limit) {
				banner_cintillo?.classList.add('sticky');
			} else {
				banner_cintillo?.classList.remove('sticky');
			}
		});
	
		// Botón de cierre
		if (closeElement) {
			closeElement.addEventListener('click', function() {
				banner_cintillo?.remove();
			});
		}
  }
</script>